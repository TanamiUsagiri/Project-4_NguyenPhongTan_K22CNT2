<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cửa hàng Điện tử</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/index.css">
</head>
<body id="home">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="index.html">
                <i class="bi bi-phone"></i> TanamiTechS
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="#home">Trang chủ</a></li>
                    <li class="nav-item"><a class="nav-link" href="#sanpham">Sản phẩm</a></li>
                    <li class="nav-item"><a class="nav-link" href="#lienhe">Liên hệ</a></li>
                    <li class="nav-item"><a class="nav-link" href="#hotro">Hỗ trợ</a></li>
                </ul>
                <form class="d-flex ms-3 position-relative" style="min-width:220px;">
                    <input id="searchInput" class="form-control me-2" type="search" placeholder="Tìm kiếm sản phẩm..." aria-label="Search" autocomplete="off">
                    <ul id="searchSuggestions" class="list-group position-absolute w-100" style="z-index: 1000; top:100%; display:none;"></ul>
                </form>
                <button class="btn position-relative ms-3 d-flex align-items-center" type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" aria-controls="cartOffcanvas">
                    <i class="bi bi-cart3 fs-4"></i>
                    <span id="cartCount" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size:0.7rem;">0</span>
                </button>
                <span id="userInfo" class="ms-3" style="display: none;">
                    Xin chào, <span id="username"></span>
                    <a href="#" id="logout" class="btn btn-danger ms-3">Đăng xuất</a>
                </span>
                <a href="login.html" id="loginLink" class="btn btn-outline-primary ms-3">Đăng nhập</a>
            </div>
        </div>
    </nav>

    <!-- Offcanvas Giỏ hàng -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="cartOffcanvasLabel">Giỏ hàng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="list-group mb-3" id="cartList">
          <!-- Sản phẩm trong giỏ sẽ được render ở đây -->
        </ul>
        <div class="d-flex justify-content-between align-items-center mb-3">
          <span class="fw-bold">Tổng cộng:</span>
          <span class="fw-bold text-primary fs-5" id="cartTotal">0đ</span>
        </div>
        <button class="btn btn-success w-100" id="checkoutBtn">Thanh toán</button>
      </div>
    </div>

    <!-- Banner -->
    <section class="bg-primary text-white py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold">Công nghệ mới nhất cho cuộc sống hiện đại</h1>
                    <p class="lead">Khám phá các sản phẩm công nghệ hàng đầu với giá ưu đãi</p>
                    <a href="#sanpham" class="btn btn-light btn-lg mt-3">Khám phá ngay</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Danh mục sản phẩm -->
    <section class="py-4 bg-light">
        <div class="container">
            <h5 class="mb-3 fw-bold">Danh mục sản phẩm</h5>
            <div class="row g-3">
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-phone fs-2 text-primary"></i>
                        <div>Điện thoại</div>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-laptop fs-2 text-primary"></i>
                        <div>Laptop</div>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-tablet fs-2 text-primary"></i>
                        <div>Máy tính bảng</div>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-music-note-beamed fs-2 text-primary"></i>
                        <div>Âm thanh</div>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-smartwatch fs-2 text-primary"></i>
                        <div>Đồng hồ thông minh</div>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <div class="card text-center py-3">
                        <i class="bi bi-gear fs-2 text-primary"></i>
                        <div>Phụ kiện</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sản phẩm nổi bật -->
    <section id="sanpham" class="py-4">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold mb-0">Sản phẩm nổi bật</h5>
                <a href="#sanpham" class="text-primary">Xem tất cả &gt;</a>
            </div>
            <div class="row g-4" id="productList">
                <div class="col-12 col-md-3 product-item" data-name="iPhone 13 Pro Max" data-hashtags='["Apple","Điện thoại","Mới","Giảm giá"]'>
                    <div class="card h-100">
                        <div class="position-absolute top-0 start-0 m-2 badge bg-danger">-18%</div>
                        <img src="assets/images/iphone13promax.jpg" class="card-img-top p-4" alt="iPhone 13 Max">
                        <div class="card-body">
                            <h6 class="card-title">iPhone 13 Pro Max</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(120)</span>
                            </div>
                            <div class="text-decoration-line-through text-muted small">29.990.000đ</div>
                            <div class="fw-bold text-primary fs-5">25.490.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="iPhone 13 Pro Max" data-price="25490000" data-img="assets/images/iphone13.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 product-item" data-name="MacBook Pro M1" data-hashtags='["Apple","Laptop","Mới"]'>
                    <div class="card h-100">
                        <div class="position-absolute top-0 start-0 m-2 badge bg-success">Mới</div>
                        <img src="assets/images/macprom1.jpg" class="card-img-top p-4" alt="MacBook Pro M1">
                        <div class="card-body">
                            <h6 class="card-title">MacBook Pro M1</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(98)</span>
                            </div>
                            <div class="fw-bold text-primary fs-5">32.990.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="MacBook Pro M1" data-price="32990000" data-img="assets/images/macbook.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 product-item" data-name="iPad Pro 2021" data-hashtags='["Apple","Máy tính bảng","Giảm giá"]'>
                    <div class="card h-100">
                        <div class="position-absolute top-0 start-0 m-2 badge bg-danger">-20%</div>
                        <img src="assets/images/ipadpro2021.jpg" class="card-img-top p-4" alt="iPad Pro 2021">
                        <div class="card-body">
                            <h6 class="card-title">iPad Pro 2021</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(75)</span>
                            </div>
                            <div class="text-decoration-line-through text-muted small">23.990.000đ</div>
                            <div class="fw-bold text-primary fs-5">19.190.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="iPad Pro 2021" data-price="19190000" data-img="assets/images/ipadpro.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 product-item" data-name="Apple Watch Series 7" data-hashtags='["Apple","Đồng hồ","Mới"]'>
                    <div class="card h-100">
                        <img src="assets/images/applewatch.jpg" class="card-img-top p-4" alt="Apple Watch Series 7">
                        <div class="card-body">
                            <h6 class="card-title">Apple Watch Series 7</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(42)</span>
                            </div>
                            <div class="fw-bold text-primary fs-5">10.990.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="Laptop Gaming" data-price="10990000" data-img="assets/images/laptopgaming.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 product-item" data-name="Laptop Gaming" data-hashtags='["Laptop","Gaming","Mới"]'>
                    <div class="card h-100">
                        <div class="position-absolute top-0 start-0 m-2 badge bg-success">Mới</div>
                        <br>
                        <img src="assets/images/laptopgaming.jpg" class="card-img-top p-4" alt="Laptop Gaming">
                        <div class="card-body">
                            <h6 class="card-title">Laptop Gaming</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(189)</span>
                            </div>
                            <div class="fw-bold text-primary fs-5">18.990.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="Laptop Gaming" data-price="18990000" data-img="assets/images/lenovotabm11.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 product-item" data-name="Máy Tính Bảng Lenovo Tab M11" data-hashtags='["Máy tính bảng","Lenovo","Mới"]'>
                    <div class="card h-100">
                        <div class="position-absolute top-0 start-0 m-2 badge bg-danger">-21%</div>
                        <br>
                        <img src="assets/images/lenovotabm11.jpg" class="card-img-top p-4" alt="Máy Tính Bảng Lenovo Tab M11">
                        <div class="card-body">
                            <h6 class="card-title">Máy Tính Bảng Lenovo Tab M11</h6>
                            <div class="mb-2">
                                <span class="text-warning">★★★★★</span>
                                <span class="text-muted ms-1">(56)</span>
                            </div>
                            <div class="fw-bold text-primary fs-5">4.690.000đ</div>
                            <div class="mt-2 hashtags"></div>
                        </div>
                        <div class="card-footer bg-white border-0 text-end">
                            <button class="btn btn-outline-primary rounded-circle add-to-cart" data-name="Máy Tính Bảng Lenovo Tab M11" data-price="6490000" data-img="assets/images/lenovotabm11.jpg"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <button class="btn btn-secondary btn-sm" id="showAllBtn" style="display:none;">Xem tất cả</button>
            </div>
        </div>
    </section>

    <!-- Đăng ký nhận thông tin -->
    <section class="bg-primary text-white py-5">
      <div class="container text-center">
        <h5 class="fw-bold mb-2">Đăng ký nhận thông tin</h5>
        <p class="mb-4">Nhận thông báo về khuyến mãi và sản phẩm mới</p>
        <form class="row justify-content-center g-2">
          <div class="col-12 col-md-6">
            <input type="email" class="form-control" placeholder="Nhập email của bạn" required>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-light fw-bold">Đăng ký</button>
          </div>
        </form>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white pt-5 pb-3 mt-0">
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-3 mb-4">
            <h6 class="fw-bold">TanamiTechS</h6>
            <p class="small">Cửa hàng thiết bị điện tử hàng đầu với các sản phẩm chính hãng và dịch vụ chất lượng.</p>
            <div>
              <a href="#" class="text-white me-2"><i class="bi bi-facebook"></i></a>
              <a href="#" class="text-white me-2"><i class="bi bi-spotify"></i></a>
              <a href="#" class="text-white"><i class="bi bi-instagram"></i></a>
            </div>
          </div>
          <div class="col-6 col-md-3 mb-4">
            <h6 class="fw-bold">Thông tin</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-white text-decoration-none">Về chúng tôi</a></li>
              <li><a href="#" class="text-white text-decoration-none">Chính sách bảo mật</a></li>
              <li><a href="#" class="text-white text-decoration-none">Điều khoản sử dụng</a></li>
              <li><a href="#" class="text-white text-decoration-none">Liên hệ</a></li>
            </ul>
          </div>
          <div id="hotro" class="col-6 col-md-3 mb-4">
            <h6 class="fw-bold">Dịch vụ Khách hàng</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-white text-decoration-none">Trung tâm hỗ trợ</a></li>
              <li><a href="#" class="text-white text-decoration-none">Cách thức mua hàng</a></li>
              <li><a href="#" class="text-white text-decoration-none">Theo dõi đơn hàng</a></li>
              <li><a href="#" class="text-white text-decoration-none">Bảo hành và sửa chữa</a></li>
            </ul>
          </div>
          <div id="lienhe" class="col-12 col-md-3 mb-4">
            <h6 class="fw-bold">Liên hệ</h6>
            <ul class="list-unstyled small">
              <li><i class="bi bi-geo-alt me-2"></i>Thường Tín, Hà Nội</li>
              <li><i class="bi bi-telephone me-2"></i>0913698863</li>
              <li><i class="bi bi-envelope me-2"></i>nguyenphongtan2004@gmail.comcom</li>
            </ul>
          </div>
        </div>
        <hr class="border-secondary">
        <div class="text-center small">&copy; 2025 TanamiTechS. Tất cả các quyền được bảo lưu.</div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script>
        // Giỏ hàng
        function getCart() {
            return JSON.parse(localStorage.getItem('cart') || '[]');
        }
        function setCart(cart) {
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        function updateCartCount() {
            const cart = getCart();
            document.getElementById('cartCount').textContent = cart.reduce((sum, item) => sum + item.qty, 0);
        }
        function renderCart() {
            const cart = getCart();
            const cartList = document.getElementById('cartList');
            const cartTotal = document.getElementById('cartTotal');
            cartList.innerHTML = '';
            let total = 0;
            if (cart.length === 0) {
                cartList.innerHTML = '<li class="list-group-item text-center">Giỏ hàng trống</li>';
            } else {
                cart.forEach((item, idx) => {
                    total += item.price * item.qty;
                    cartList.innerHTML += `
                        <li class="list-group-item d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <img src="${item.img}" alt="${item.name}" width="40" class="me-2 rounded">
                                <div>
                                    <div>${item.name}</div>
                                    <small class="text-muted">${item.price.toLocaleString()}đ x ${item.qty}</small>
                                </div>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-secondary me-1" onclick="changeQty(${idx}, -1)">-</button>
                                <button class="btn btn-sm btn-outline-secondary" onclick="changeQty(${idx}, 1)">+</button>
                                <button class="btn btn-sm btn-danger ms-2" onclick="removeCartItem(${idx})"><i class="bi bi-trash"></i></button>
                            </div>
                        </li>
                    `;
                });
            }
            cartTotal.textContent = total.toLocaleString() + 'đ';
        }
        function addToCart(name, price, img) {
            let cart = getCart();
            const idx = cart.findIndex(item => item.name === name);
            if (idx > -1) {
                cart[idx].qty += 1;
            } else {
                cart.push({ name, price, img, qty: 1 });
            }
            setCart(cart);
            updateCartCount();
        }
        function changeQty(idx, delta) {
            let cart = getCart();
            cart[idx].qty += delta;
            if (cart[idx].qty <= 0) cart.splice(idx, 1);
            setCart(cart);
            updateCartCount();
            renderCart();
        }
        function removeCartItem(idx) {
            let cart = getCart();
            cart.splice(idx, 1);
            setCart(cart);
            updateCartCount();
            renderCart();
        }
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.addEventListener('click', function() {
                addToCart(this.dataset.name, Number(this.dataset.price), this.dataset.img);
            });
        });
        document.getElementById('cartOffcanvas').addEventListener('show.bs.offcanvas', renderCart);
        updateCartCount();

        // Kiểm tra trạng thái đăng nhập
        function checkLogin() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const userInfo = document.getElementById('userInfo');
            const loginLink = document.getElementById('loginLink');
            const username = document.getElementById('username');

            if (currentUser) {
                userInfo.style.display = 'inline';
                loginLink.style.display = 'none';
                username.textContent = (currentUser.lastname ? currentUser.lastname + ' ' : '') + (currentUser.firstname || currentUser.email);
            } else {
                userInfo.style.display = 'none';
                loginLink.style.display = 'inline';
            }
        }

        // Xử lý đăng xuất
        document.getElementById('logout').addEventListener('click', function(e) {
            e.preventDefault();
            localStorage.removeItem('currentUser');
            checkLogin();
            window.location.href = 'index.html';
        });

        // Kiểm tra đăng nhập khi trang được tải
        window.addEventListener('load', checkLogin);

        // Thanh toán
        document.getElementById('checkoutBtn').addEventListener('click', function() {
            const cart = getCart();
            if (cart.length === 0) {
                alert('Giỏ hàng trống!');
                return;
            }
            alert('Thanh toán thành công!');
            setCart([]);
            updateCartCount();
            renderCart();
        });

        // Render hashtag cho từng sản phẩm
        document.querySelectorAll('.product-item').forEach(function(item) {
            const hashtags = JSON.parse(item.getAttribute('data-hashtags'));
            const container = item.querySelector('.hashtags');
            hashtags.forEach(tag => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-sm btn-outline-secondary me-1 mb-1 hashtag-btn';
                btn.textContent = '#' + tag;
                btn.setAttribute('data-tag', tag);
                container.appendChild(btn);
            });
        });
        // Lọc sản phẩm theo hashtag
        function filterByHashtag(tag) {
            document.querySelectorAll('.product-item').forEach(function(item) {
                const hashtags = JSON.parse(item.getAttribute('data-hashtags'));
                if (hashtags.includes(tag)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
            document.getElementById('showAllBtn').style.display = 'inline-block';
        }
        // Lọc sản phẩm theo search bar
        document.querySelector('input[type="search"]').addEventListener('input', function() {
            const keyword = this.value.trim().toLowerCase();
            document.querySelectorAll('.product-item').forEach(function(item) {
                const name = item.getAttribute('data-name').toLowerCase();
                const hashtags = JSON.parse(item.getAttribute('data-hashtags')).map(t => t.toLowerCase());
                if (name.includes(keyword) || hashtags.some(t => t.includes(keyword))) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
            document.getElementById('showAllBtn').style.display = 'inline-block';
        });
        // Sự kiện click hashtag
        document.querySelectorAll('.hashtag-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
                filterByHashtag(this.getAttribute('data-tag'));
            });
        });
        // Nút xem tất cả
        document.getElementById('showAllBtn').addEventListener('click', function() {
            document.querySelectorAll('.product-item').forEach(function(item) {
                item.style.display = '';
            });
            this.style.display = 'none';
            document.querySelector('input[type="search"]').value = '';
        });

        // Gợi ý sản phẩm khi nhập vào thanh tìm kiếm
        function getAllProductNames() {
            return Array.from(document.querySelectorAll('.product-item')).map(item => ({
                name: item.getAttribute('data-name'),
                img: item.querySelector('img')?.src || ''
            }));
        }

        const searchInput = document.getElementById('searchInput');
        const suggestionsBox = document.getElementById('searchSuggestions');

        searchInput.addEventListener('input', function() {
            const keyword = this.value.trim().toLowerCase();
            const products = getAllProductNames();
            if (!keyword) {
                suggestionsBox.style.display = 'none';
                suggestionsBox.innerHTML = '';
                return;
            }
            const matches = products.filter(p => p.name.toLowerCase().includes(keyword));
            if (matches.length === 0) {
                suggestionsBox.style.display = 'none';
                suggestionsBox.innerHTML = '';
                return;
            }
            suggestionsBox.innerHTML = matches.map(p =>
                `<li class="list-group-item list-group-item-action d-flex align-items-center suggestion-item" style="cursor:pointer;">
                    <img src="${p.img}" alt="" width="32" class="me-2 rounded">
                    <span>${p.name}</span>
                </li>`
            ).join('');
            suggestionsBox.style.display = 'block';
        });

        // Khi click vào gợi ý, tự động điền vào ô tìm kiếm và lọc sản phẩm
        suggestionsBox.addEventListener('click', function(e) {
            const item = e.target.closest('.suggestion-item');
            if (item) {
                const name = item.querySelector('span').textContent;
                searchInput.value = name;
                suggestionsBox.style.display = 'none';
                // Lọc sản phẩm theo tên
                document.querySelectorAll('.product-item').forEach(function(p) {
                    if (p.getAttribute('data-name') === name) {
                        p.style.display = '';
                    } else {
                        p.style.display = 'none';
                    }
                });
                document.getElementById('showAllBtn').style.display = 'inline-block';
            }
        });

        // Ẩn gợi ý khi click ra ngoài
        window.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !suggestionsBox.contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });
    </script>
</body>
</html>
